@page
@model AspPix.Pages.IndexModel
@{
}

@using AspPix
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, AspPix

<div>
    <script>
        (function () {
            document.addEventListener("DOMContentLoaded", function () {

                let up = document.getElementsByClassName("up");

                let down = document.getElementsByClassName("down");

                let f = document.getElementById("form");

                let n = document.getElementById("down");

                let tag = document.getElementById("tag");

                let select = document.getElementById("select");


                let sel_v = select.value;

                let tag_v = tag.value;

                function add(ie, func) {

                    Array.from(ie, function (v) {

                        v.onclick = func;
                    });
                }

                function fuck() {


                    if (tag.value !== tag_v || select.value !== sel_v) {
                        n.value = 0;

                        return;
                    }
                }


                add(up, function () {

                    if (n.value) {

                        let count = Number(n.value);

                        if (count > 0) {

                            n.value = count - 1;

                            fuck();
                            f.submit();
                        }


                    }
                });


                add(down, function () {
                    if (n.value) {

                        let count = Number(n.value);

                        n.value = count + 1;

                        fuck();
                        f.submit();


                    }
                });
            });

                  
        })();
    </script>
    <div>
        <form id="form" method="get">
            <select name="select" id="select">
                <option value="">All</option>
                @foreach (var item in Model.Tags)
                {
                    if (Model.Select == item)
                    {
                <option value="@item" selected>@item</option>
                    }
                    else
                    {
                <option value="@item">@item</option>
                    }

                }

            </select>
            <input type="text" name="tag" id="tag" value="@Model.Tag" />
            <input type="number" name="down" id="down" value="@Model.Down" />
        </form>
        <button class="up">上一页</button>
        <button class="down">下一页</button>
    </div>
    <div>
        @foreach (var item in Model.Scrs)
        {
        @*<myimg height="540" src="@item.small" />*@
        <a href="@item.big" target="_blank"><my-img img-uri="@item.small"></my-img></a>
        }
    </div>
    <div>
        <button class="up">上一页</button>
        <button class="down">下一页</button>
    </div>
</div>
